<source>
  @type  forward
  @id    input1
  port  24224
</source>

# TODO - pozbyc sie tego, parsowanie powinno byc w fluentd-logger.go
<filter vehicle.log>
  @type record_transformer
  enable_ruby
  <record>
    location ${JSON.parse(record["location"])}
  </record>
</filter>

# TODO - pozbyc sie tego
<filter vehicle.map>
  @type record_transformer
  enable_ruby
  <record>
    location_array ${JSON.parse(record["location_array"].gsub("Lat", "lat").gsub("Lon", "lon"))}
    alpha_array ${JSON.parse(record["alpha_array"])}
  </record>
</filter>


<match vehicle.{log,map,trip}>
  @type elasticsearch_dynamic
  host elastic
  port 9200
  index_name simulation-${tag_parts[1]}-1
  type_name _doc
  <buffer>
    buffer_type memory
    flush_interval 5s
    retry_limit 17
    retry_wait 1.0
    num_threads 4
  </buffer>
</match>





